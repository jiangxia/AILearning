# Pattern | Claude都出4.5了，你还不懂工具调用的架构革命

上周我给Claude code（以下简称CC）配置MCP，发现死活连不上，同样的操作，在Claude Desktop是能用的。最后发现是工具命名出问题。

我突然意识到，我虽然用了很久的CC，但我其实没真正理解工具调用（Tool Use）背后的架构设计。

我上网查了下，发现很多人在吐槽，大致有以下的问题：

1. **MCP服务器在Desktop能用，Code连不上，到底怎么回事？**
2. **MCP和LangChain都能给AI加工具，为什么要搞两套？**
3. **电脑使用（Computer Use）准确率只有14.9%，这么低还有啥用？**
4. **Claude说能连续工作30小时，SWE-bench拿77.2%，怎么做到的？**
5. **工具调用失败，错误信息看不懂，怎么快速定位？**

所以索性写一篇文章，系统介绍一下，也当做学习。

---

## 工具调用的本质：从对话到行动

我们知道，以前跟AI聊天很简单，你问问题，Claude就立马给你一段答复，他很强，但他充其量就是一个聊天机器人。

有了工具调用就不一样了。现在的Claude，仿佛安装了手脚，他可以动手操作电脑、读取文件、执行代码，甚至还能搜索网络。

那Claude具体有哪些工具呢？——9个！

**比如获取信息的**。Claude有网络搜索工具工具（Web Search），能搜索互联网，找最新资料。网页获取工具（Web Fetch）能抓取网页内容，并进行深度阅读。MCP连接器（MCP Connector）能连接外部服务器，并获取专业数据。

**还有写代码的**。代码执行工具（Code Execution）可以在沙盒里跑代码，并验证想法。文本编辑器（Text Editor）能编辑文本文件，以及修改配置。命令行工具（Bash）能执行命令行，并自动化操作。

以上这些都很常规？别急，还有**更智能的**。电脑使用工具（Computer Use）可以直接操作电脑界面，像人一样点击。记忆工具（Memory Tool）能跨对话记忆，记住你的重要信息。PDF支持工具（PDF Support）可以处理PDF文档，读取复杂格式。

说到这，你可能会问，Claude为什么不像GPT那样做成插件（Plugin）市场呢？

非常好的问题，这就要说到MCP协议的设计哲学了。

---

## MCP协议：解决N×M问题

之前我就纳闷，langChain已经可以给AI加工具，MCP为什么要多此一举呢？

后来才明白，两者的定位不同。

LangChain的定位是开发框架，目标是帮你快速搭建AI应用。而MCP是标准协议，是让服务商和AI应用之间有统一的调用接口。

假设你是一个服务提供商，想让AI调用你的服务。用LangChain的话，你要写：

1. 一个Python包装类
2. 一个JavaScript包装类
3. 一个Java包装类
4. 一个Go包装类

这涉及一个非常恼人的现实，因为不同AI应用可能用不同语言开发，你必须为每一种语言开发一套代码。

而这，就是行业里说的N×M问题：

1. N个服务提供商
2. M种编程语言
3. 需要写N×M个集成

而MCP就没这个问题，他的思路是把乘法变成加法：10个服务、10种语言。那就写20个实现。

之所以可以做到，是因为MCP的定位就像USB-C接口。

举个例子你就懂了。以前我们的手机、电脑、耳机、相机，都是用不同的充电线，非常麻烦。后面统一成USB-C接口，出门带一条线就够了。

同理，服务商统一实现一个MCP接口，所有支持MCP的AI应用都能用，问题就迎刃而解。

此外，MCP最聪明的地方其实是能力声明。

当Claude连接一个MCP服务器时，MCP会告诉他："我有这些工具，每个工具的参数是什么，返回值是什么。"

Claude看到这些声明，就可以自己决定要不要调用、怎么调用。

这跟传统的插件完全不同，传统的插件是先定义好自己的功能，等着别人使用，可问题是，AI不知道插件能干啥

MCP是把自动权给到AI，让AI自己决定如何使用。

这就是MCP比插件高明的地方：**标准化的能力声明 + AI自主决策**。

回到开篇的问题，为啥同样的MCP，Desktop能用，CC不行？那是因为CC更严格，他对工具命名都有自己的要求。比如工具名只能包含字母、数字、下划线和破折号。Desktop没有这些要求。

比如你的工具名叫`get.user.info`。Desktop能用，但CC不行，他会报错`tools.11.custom.name: String should match pattern`。

---

## 30小时自主工作的秘密

很多人好奇Claude Sonnet 4.5怎么做到30个小时不停歇地工作。其实关键有3个原因。

### 1. 反馈循环

比如，Claude4.5不会一上来就无脑写代码，而是先用扩展思考（Extended Thinking）深度分析问题，理清楚思路，确认bug的原因是什么？需要怎样修改，是否影响其他模块？想清楚之后，Claude会制定详细的计划。然后才执行。

如果执行中遇到报错，Claude不会直接结束，而是调整策略。比如测试失败了，会主动去读取错误日志，定位问题，然后修改代码，重新测试，直到把问题解决。

这个过程更像是一个程序员在调试代码，而不是一个机器人在机械执行指令。

### 2. 并行工具调用

这次Claude4.5更新后，我就惊喜地发现，他网络搜索时，可以一次性发起多个任务，而不像以前，只能只能检索一个。

这是因为，Claude4.5支持并行调用。

类似的情况还有，你让Claude分析一个项目。他可以同时读`package.json`了解依赖、读`README.md`了解项目结构、读`src/index.js`看主入口，效率一下子就提高了不少。

除此之外，Claude还做到了推测性搜索。

Claude不需要你主动跟他说查找哪个文件，他会根据上下文的信息主动去搜索。这就方便了。

当你说修复某个BUG，你肯定不希望你帮Claude去定位哪个文件，他会自动根据日志信息顺藤摸瓜找到相应的文件。

这就是为什么Claude能在SWE-bench Verified拿到77.2%准确率。

很多人不了解SWE-bench，他是一个真实的软件工程任务，会给你一个GitHub Issue，你要根据问题写代码，测试，并确保测试通过。

所以说，Claude为啥强大，是因为他做到了：**反馈循环 + 并行工具调用 + 推测性搜索**。

### 3. Computer Use的视觉感知

要说最智能最好用，还得是Computer Use，他让Claude看到你的屏幕、操作你的鼠标跟键盘。

实现方面，Claude每次执行操作前，会先截屏。然后用视觉工具（Vision）分析当前界面，并思考下一步操作。

比如要操作一个网站的登录界面，Claude会分析出需要输入用户名和密码。然后移动鼠标到用户名输入框，再截屏确认光标位置，然后就可以输入用户名。

这样做的好处是，Claude不需要知道网页的API，也不需要知道网页的HTML结构，整个流程是纯视觉驱动的。

不过目前Claude的准确率只有14.9%，GPT-4是7.7%。这个技术的潜力还是很大。

---

## 快速解答

到这里这篇文章就结束了，关于开篇提到的5个问题，你应该有答案了。

为啥MCP在Desktop能用，在CC不行，是因为CC要求更严格，最常见的原因是工具命名不规范。

而为啥有了LangChain，还要MCP，是两者定位不同，LangChain是开发框架，能帮你快速搭建AI应用，而MCP是标准协议，能让服务商遵循一个统一的标准进行开发，从而解决N×M的问题。简单理解，MCP就跟USB插口一样。

至于Computer Use准确率只有14.9%，为啥还要用。是因为Computer Use的初衷不是为了100%自动化，而是为了辅助人类。而且技术本身也在迭代，以后的准确率肯定会提高。

再说为啥Claude能连续工作30小时，主要是3点：反馈循环 + 并行工具调用 + 推测性搜索。

最后，工具调用失败怎么办？常见错误无非是工具参数不对、工具返回值格式不对、或者工具本身报错。快速定位的方法也很简单，开启一下调试模式`claude --debug`，查看完整工具调用日志，看看输入输出是否符合schema声明就行。


---

## 深入交流

想要深入交流AI实践经验？欢迎关注，一起探讨AI时代的无限可能！

---

> ### 关于本人 ｜ 黄彦湘
> 深耕互联网行业9年，专注前端开发技术方向，现为广州执业律师，同时兼备专利代理师资质。基于丰富的技术背景和法律实践经验，现为深度实践（Deepractice）社区核心贡献者，致力于推动AI深度实践在法律、小说创作等多元领域的创新应用与探索。
> **全网同名**：明易AI实践

---
